#ifndef TV_FIRST_SIGHT_H
#define TV_FIRST_SIGHT_H

#include "geometry.h"
#include "math_solver.h"
#include <optional>

class FirstSightFinder {
    const Polygon& P;

    // Determines if line of sight segment qr exists wholly within P at time t.
    bool verify_visibility_at(double t, const Trajectory& q, const Trajectory& r) const;

public:
    explicit FirstSightFinder(const Polygon& poly) : P(poly) {}

    // Computes the earliest visibility time t* >= 0.
    // Iterates through critical event candidates generated by P's vertices.
    std::optional<double> find_first_sight(const Trajectory& q, const Trajectory& r) const;
};

#endif // TV_FIRST_SIGHT_H